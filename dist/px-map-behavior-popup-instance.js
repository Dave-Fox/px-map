'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};(function(){'use strict';var PopupInstance={properties:{active:{type:Boolean,value:false,readOnly:true},parentInstance:{type:Object,notify:true},bindToControl:{type:String}},observers:['_attachToParentInstance(parentInstance)'],ready:function ready(){var instance=this._createElementInstance();this._setElementInstance(instance)},attached:function attached(){this._attachToParentInstance()},detached:function detached(){this._detachFromParentInstance()},_createElementInstance:function _createElementInstance(){var popup=this._createPopupInstance();return popup},_createPopupInstance:function _createPopupInstance(){return L.popup()},_attachToParentInstance:function _attachToParentInstance(){if(!this.parentInstance)return;this._bindPopupInstanceEvents();if(this.bindToControl&&this.bindToControl.length){return}if(this.parentInstance.getPopup()!==this.elementInstance){this.parentInstance.bindPopup(this.elementInstance)}},_detachFromParentInstance:function _detachFromParentInstance(){if(!this.parentInstance)return;this._unbindPopupInstanceEvents();if(this.parentInstance.getPopup()===this.elementInstance){this.parentInstance.removeLayer(this.elementInstance)}},_bindPopupInstanceEvents:function _bindPopupInstanceEvents(){if(!this.parentInstance)return;this._boundPopupEvents=this._boundPopupEvents||{};if(!this._boundPopupEvents.popupopen&&typeof this._handlePopupOpen==='function'){this._boundPopupEvents.popupopen=this._handlePopupOpen.bind(this)}if(!this._boundPopupEvents.popupclose&&typeof this._handlePopupClose==='function'){this._boundPopupEvents.popupclose=this._handlePopupClose.bind(this)}if(!this._boundPopupEvents.click&&this.bindToControl&&this.bindToControl.length){this._boundPopupEvents.click=this._handlePopupParentClick.bind(this)}this.parentInstance.on(this._boundPopupEvents)},_unbindPopupInstanceEvents:function _unbindPopupInstanceEvents(){if(!this.parentInstance)return;if(_typeof(this._boundPopupEvents)==='object'){this.parentInstance.off(this._boundPopupEvents)}},_handlePopupParentClick:function _handlePopupParentClick(evt){if(this.bindToControl&&this.bindToControl.length){this._map=evt.target._map;this._boundPopupMapEvents={click:this._handlePopupMapClick.bind(this)};this._map.on(this._boundPopupMapEvents);this.fire('px-map-info-control-bind',{content:this.elementInstance.getContent(),control:this.bindToControl,popup:this.elementInstance});evt.stopPropagation()}},_handlePopupMapClick:function _handlePopupMapClick(evt){if(this.bindToControl&&this.bindToControl.length){this.fire('px-map-info-control-unbind',{content:'',control:this.bindToControl})}this._map.off(this._boundPopupMapEvents)}};var namespace=window.PxMapBehavior=window.PxMapBehavior||{};namespace.PopupInstance=PopupInstance})();
//# sourceMappingURL=px-map-behavior-popup-instance.js.map
