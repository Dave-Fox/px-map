{"version":3,"sources":["px-map-behavior-common.es6.js"],"names":["Common","LatLng","properties","LayerParent","created","_attachedChildren","WeakMap","detached","_detachLayerChildren","listeners","_tryToAddAllChildren","evt","elementInst","srcElement","_attachLayerChildren","_tryToAddOneChild","stopPropagation","_attachLayerChild","children","getEffectiveChildren","length","child","childEl","has","willAddInst","addInst","canAddInst","set","async","_detachLayerChild","willRemoveInst","removeInst","delete","LayerChild","namespace","window","PxMapBehavior"],"mappings":"aAAA,CAAC,UAAW,CACV,aAEA,GAAMA,QAAS,EAAf,CAMAA,OAAOC,MAAP,CAAgB,CACdC,WAAY,EADE,CAAhB,CAQAF,OAAOG,WAAP,CAAqB,CACnBC,OADmB,mBACT,CAER,KAAKC,iBAAL,CAAyB,KAAKA,iBAAL,EAA0B,GAAIC,QACxD,CAJkB,CAMnBC,QANmB,oBAMR,CACT,KAAKC,oBAAL,EACD,CARkB,CAUnBC,UAAW,CACT,gCAAkC,sBADzB,CAET,4BAA8B,mBAFrB,CAVQ,CAiBnBC,oBAjBmB,+BAiBEC,GAjBF,CAiBO,CAGxB,GAAI,CAAC,KAAKC,WAAN,EAAqBD,IAAIE,UAAJ,GAAmB,IAA5C,CAAkD,OAGlD,KAAKC,oBAAL,EACD,CAxBkB,CA0BnBC,iBA1BmB,4BA0BDJ,GA1BC,CA0BI,CAErB,GAAIA,IAAIE,UAAJ,GAAmB,IAAvB,CAA6B,OAG7BF,IAAIK,eAAJ,GAGA,GAAI,CAAC,KAAKJ,WAAV,CAAuB,OAEvB,KAAKK,iBAAL,CAAuBN,IAAIE,UAA3B,CACD,CArCkB,CAuCnBC,oBAvCmB,gCAuCI,CACrB,GAAMI,UAAW,KAAKC,oBAAL,EAAjB,CACA,GAAI,CAACD,QAAD,EAAa,CAACA,SAASE,MAA3B,CAAmC,OAFd,gGAIrB,kBAAkBF,QAAlB,oHAA4B,IAAnBG,MAAmB,aAC1B,KAAKJ,iBAAL,CAAuBI,KAAvB,CACD,CANoB,4LAOtB,CA9CkB,CAgDnBJ,iBAhDmB,4BAgDDK,OAhDC,CAgDQ,gBACzB,GAAI,KAAKjB,iBAAL,CAAuBkB,GAAvB,CAA2BD,OAA3B,GAAuC,CAACA,QAAQE,WAAhD,EAA+D,CAACF,QAAQG,OAAxE,EAAmF,CAACH,QAAQI,UAA5F,EAA0G,CAACJ,QAAQI,UAAR,EAA/G,CAAqI,OACrI,KAAKrB,iBAAL,CAAuBsB,GAAvB,CAA2BL,OAA3B,CAAoC,IAApC,EAEA,KAAKM,KAAL,CAAW,UAAM,CAAEN,QAAQE,WAAR,EAAwB,CAA3C,EACA,KAAKI,KAAL,CAAW,UAAM,CAAEN,QAAQG,OAAR,CAAgB,MAAKb,WAArB,CAAoC,CAAvD,CACD,CAtDkB,CA0DnBJ,oBA1DmB,gCA0DI,CACrB,GAAMU,UAAW,KAAKC,oBAAL,EAAjB,CACA,GAAI,CAACD,QAAD,EAAa,CAACA,SAASE,MAA3B,CAAmC,OAFd,mGAIrB,mBAAkBF,QAAlB,yHAA4B,IAAnBG,MAAmB,cAC1B,KAAKQ,iBAAL,CAAuBR,KAAvB,CACD,CANoB,mMAOtB,CAjEkB,CAmEnBQ,iBAnEmB,4BAmEDP,OAnEC,CAmEQ,CACzB,GAAI,CAAC,KAAKjB,iBAAL,CAAuBkB,GAAvB,CAA2BD,OAA3B,CAAD,EAAwC,CAACA,QAAQQ,cAAjD,EAAmE,CAACR,QAAQS,UAAhF,CAA4F,OAC5F,KAAK1B,iBAAL,CAAuB2B,MAAvB,CAA8BV,OAA9B,EAEA,KAAKM,KAAL,CAAW,UAAM,CAAEN,QAAQQ,cAAR,EAA2B,CAA9C,EACA,KAAKF,KAAL,CAAW,UAAM,CAAEN,QAAQS,UAAR,EAAuB,CAA1C,CACD,CAzEkB,CAArB,CAgFA/B,OAAOiC,UAAP,CAAoB,CAClB/B,WAAY,EADM,CAApB,CAIA,GAAMgC,WAAaC,OAAOC,aAAP,CAAuBD,OAAOC,aAAP,EAAwB,EAAlE,CACAF,UAAUlC,MAAV,CAAmBkC,UAAUlC,MAAV,EAAoBA,MACxC,CAvGD","file":"px-map-behavior-common.js","sourcesContent":["(function() {\n  'use strict';\n\n  const Common = {};\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.Common.LatLng\n   */\n  Common.LatLng = {\n    properties: {}\n  };\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.Common.LayerParent\n   */\n  Common.LayerParent = {\n    created() {\n      // Use a WeakMap to keep track of our attached children\n      this._attachedChildren = this._attachedChildren || new WeakMap();\n    },\n\n    detached() {\n      this._detachLayerChildren();\n    },\n\n    listeners: {\n      'px-map-layer-instance-created' : '_tryToAddAllChildren',\n      'px-map-layer-ready-to-add' : '_tryToAddOneChild'\n    },\n\n    // Handles attaching children throughout this element's lifecycle\n\n    _tryToAddAllChildren(evt) {\n      // If this element's elementInst isn't ready, halt and wait until later\n      // If this event isn't coming from this element, do not handle\n      if (!this.elementInst || evt.srcElement !== this) return;\n\n      // If my own elementInst was just created, loop over children and try to attach them\n      this._attachLayerChildren();\n    },\n\n    _tryToAddOneChild(evt) {\n      // If the added-to-dom event belongs to this element, just return and let it bubble\n      if (evt.srcElement === this) return;\n\n      // This element is the parent, so stop this event from bubbling\n      evt.stopPropagation();\n\n      // If I have no elementInst, halt and wait until later\n      if (!this.elementInst) return;\n\n      this._attachLayerChild(evt.srcElement);\n    },\n\n    _attachLayerChildren() {\n      const children = this.getEffectiveChildren();\n      if (!children || !children.length) return;\n\n      for (let child of children) {\n        this._attachLayerChild(child);\n      }\n    },\n\n    _attachLayerChild(childEl) {\n      if (this._attachedChildren.has(childEl) || !childEl.willAddInst || !childEl.addInst || !childEl.canAddInst || !childEl.canAddInst()) return;\n      this._attachedChildren.set(childEl, true);\n\n      this.async(() => { childEl.willAddInst(); });\n      this.async(() => { childEl.addInst(this.elementInst); });\n    },\n\n    // Handles detaching children throughout this element's lifecycle\n\n    _detachLayerChildren() {\n      const children = this.getEffectiveChildren();\n      if (!children || !children.length) return;\n\n      for (let child of children) {\n        this._detachLayerChild(child);\n      }\n    },\n\n    _detachLayerChild(childEl) {\n      if (!this._attachedChildren.has(childEl) || !childEl.willRemoveInst || !childEl.removeInst) return;\n      this._attachedChildren.delete(childEl);\n\n      this.async(() => { childEl.willRemoveInst(); });\n      this.async(() => { childEl.removeInst(); });\n    }\n  };\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.Common.LayerChild\n   */\n  Common.LayerChild = {\n    properties: {}\n  };\n\n  const namespace = (window.PxMapBehavior = window.PxMapBehavior || {});\n  namespace.Common = namespace.Common || Common;\n})()\n"]}