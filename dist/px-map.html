<!--
    Relative paths assume component is being run from inside an app or another component, where dependencies are flat
    siblings. When this component is run from its own repo (e.g. tests, examples), we assume the server is started with
    'gulp serve' (or similar server setup) to enable correct finding of bower dependencies for local runs.
-->
<link rel="import" href="../../polymer/polymer.html"/>

<!-- Load required PxMapBehaviors -->
<link rel="import" href="px-map-behavior-root.html">

<!-- Import style modules -->
<link rel="import" href="../css/px-map-leaflet-styles.html">
<link rel="import" href="../css/px-map-styles.html">

<!--
A lightweight framework for building interactive maps using Polymer web components.
The framework includes `px-map`, a base mapping component that can be extended by
and controls a variety of subcomponents that display geospatial data, offer
controls for the user, and accomplish other common mapping tasks.

Below is a simple example with little configuration that will display a map
centered on Tokyo, Japan:

    <px-map lat="35.6895" lng="139.6917" zoom="12">
      <px-map-tile-layer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"></px-map-tile-layer>
    </px-map>

Maps can be extended with a variety of attributes and also by passing subcomponents
into the tag. We can extend the map above by changing how the map initially draws
in its container, and by placing an overlay layer with markers showing interesting
landmarks in Tokyo:

    <px-map lat="35.6895" lng="139.6917" zoom="15" flex-to-size fit-to-markers>
      <px-map-tile-layer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"></px-map-tile-layer>
      <px-map-layer-group name="Landmarks">
        <px-map-marker-static lat="35.6763976" lng="35.6763976">
          <px-map-popup-info title="Meiji Jingu" description="Shinto shrine dedicated to the Emperor Meiji and Empress Shoken."></px-map-popup-info>
        </px-map-marker-static>
        <px-map-marker-static lat="35.6654861" lng="139.7706668">
          <px-map-popup-info title="Tsukiji Market" description="Sprawling wholesale fish market with an array of seafood & viewing areas for a popular tuna auction."></px-map-popup-info>
        </px-map-marker-static>
      </px-map-layer-group>
    </px-map>

See the subcomponents' API documentation pages for more information on possible
options and configurations.

### What's provided

The following pieces are provided by `px-map` and its subcomponents:

- **Base map**: Orchestrates tile layers, overlay layers, and interactive controls
- **Tile layers**: Display mapping tiles showing geography or other information
- **Layer groups**: Display interactive geospatial data on top of the map tiles
- **UI components**: Display markers, circles, polygons, and other repsentations of data on the map
- **Controls**: Offer a variety of user controls to manipualte the map and explore its data

### Underlying map library

The current iteration of `px-map` uses the open source Leaflet library as a base
for displaying a map with base tiles and geospatial overlays. Future iterations of
the component may offer the ability to use a different library in place of
Leaflet, while keeping the same basic API.

@element px-map
@blurb A lightweight framework for building interactive maps with web components
@homepage index.html
@demo index.html
-->

<dom-module id="px-map">
  <template>
    <!-- Vendor style modules to provide base styling -->
    <style include="px-map-leaflet-styles"></style>

    <!-- This should always be the last style module imported to override default styles -->
    <style include="px-map-styles"></style>

    <style>
      /* By default, just fill container */
      :host {
        display: block;
        position: relative;
      }
      :host #map {
        position: absolute;
        width: 100%;
        height: 100%;
      }
      /* Use flex to resize */
      :host([flex-to-size]) {
        display: flex;
        flex: 1;
      }
      :host([flex-to-size]) #map {
        flex: 1;
      }
    </style>
    <div id="map"></div>
    <content select="*"></content>
  </template>
</dom-module>
<script>
  Polymer({
    is: 'px-map',
    behaviors: [PxMapBehavior.LeafletRoot]
  });
</script>
