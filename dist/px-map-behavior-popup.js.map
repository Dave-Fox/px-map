{"version":3,"sources":["px-map-behavior-popup.es6.js"],"names":["namespace","window","PxMapBehavior","PopupImpl","properties","active","type","Boolean","value","readOnly","bindToControl","String","addInst","parent","getPopup","elementInst","bindPopup","removeInst","unbindPopup","Popup","Layer","InfoPopupImpl","title","observer","description","imgSrc","createInst","options","PxMap","InfoPopup","updateInst","lastOptions","nextOptions","updates","Object","keys","length","updateSettings","getInstOptions","DataPopupImpl","data","DataPopup","klass","settings","config","_createPopup","content","_generatePopupContent","defaultConfig","className","composedConfig","assign","initialize","setContent","tmplFnIf","fn","vals","undefined","call","imgTmpl","titleTmpl","descriptionTmpl","update","L","maxWidth","minWidth","dataTmpl","dataList","reduce","accum","key","concat","dataItemTmpl","join","label"],"mappings":"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","file":"px-map-behavior-popup.js","sourcesContent":["(function() {\n  'use strict';\n\n  /****************************************************************************\n   * BEHAVIORS\n   ****************************************************************************/\n\n  /* Ensures the behavior namespace is created */\n  const namespace = (window.PxMapBehavior = window.PxMapBehavior || {});\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.Popup\n   */\n  const PopupImpl = {\n    properties: {\n      /**\n       * Will be `true` when the popup becomes visible, and `false` when the\n       * popup is not visible.\n       */\n      active: {\n        type: Boolean,\n        value: false,\n        readOnly: true\n      },\n\n      /**\n       * The name of a control or another element on the map that will handle\n       * this popup's content. If this attribute is provided, the popup will\n       * not open as box with a pointer over its parent when the parent is\n       * clicked. The popup will fire an event that should be captured above\n       * with its content to place into a control.\n       */\n      bindToControl: {\n        type: String\n      }\n    },\n\n    addInst(parent) {\n      if (parent && parent.getPopup() !== this.elementInst) {\n        parent.bindPopup(this.elementInst);\n      }\n    },\n\n    removeInst(parent) {\n      if (parent && parent.getPopup() === this.elementInst) {\n        parent.unbindPopup(this.elementInst);\n      }\n    }\n  };\n  /* Bind Popup behavior */\n  namespace.Popup = [\n    namespace.Layer,\n    PopupImpl\n  ];\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.InfoPopup\n   */\n  const InfoPopupImpl = {\n    properties: {\n      /**\n       * Title text to display in bold at the top of the popup. Should be kept\n       * relatively short (25 characters or less) to keep the popup from\n       * growing too large.\n       *\n       * @type {String}\n       */\n      title: {\n        type: String,\n        observer: 'shouldUpdateInst'\n      },\n\n      /**\n       * Description text to place in the body of the popup. Try to keep the\n       * description to a reasonable size to keep the popup from growing\n       * too large.\n       *\n       * To display more information, bind to the popup's\n       * `active` property for notifications on when this popup is shown\n       * and display additional information in the UI of your app.\n       *\n       * @type {String}\n       */\n      description: {\n        type: String,\n        observer: 'shouldUpdateInst'\n      },\n\n      /**\n       * The URL for an image to place inside the popup. Use a small, square\n       * thumbnail-style image (e.g. 75px by 75px).\n       *\n       * @type {String}\n       */\n      imgSrc: {\n        type: String,\n        observer: 'shouldUpdateInst'\n      }\n    },\n\n    createInst(options) {\n      return new PxMap.InfoPopup(options);\n    },\n\n    updateInst(lastOptions, nextOptions) {\n      let updates = {};\n\n      if (lastOptions.title !== nextOptions.title) {\n        updates.title = nextOptions.title;\n      }\n      if (lastOptions.description !== nextOptions.description) {\n        updates.description = nextOptions.description;\n      }\n      if (lastOptions.imgSrc !== nextOptions.imgSrc) {\n        updates.imgSrc = nextOptions.imgSrc;\n      }\n\n      if (Object.keys(updates).length) {\n        this.elementInst.updateSettings(updates);\n      }\n    },\n\n    getInstOptions() {\n      return {\n        title: this.title,\n        description: this.description,\n        imgSrc: this.imgSrc\n      };\n    }\n  };\n  /* Bind InfoPopup behavior */\n  namespace.InfoPopup = [\n    namespace.Popup,\n    InfoPopupImpl\n  ];\n\n  /**\n   *\n   * @polymerBehavior PxMapBehavior.DataPopup\n   */\n  const DataPopupImpl = {\n    properties: {\n      /**\n       * Title text to display in bold at the top of the popup. Should be kept\n       * relatively short (25 characters or less) to keep the popup from\n       * growing too large.\n       */\n      title: {\n        type: String,\n        observer: 'shouldUpdateInst'\n      },\n\n      /**\n       * A list of key/value pairs to display in a data table. Must be in the\n       * format of an object with human-readable keys and associated values.\n       *\n       * For example, to show the name and location of a place, set this\n       * attribute to:\n       * '{ \"Name\" : \"Tokyo\", \"Location\" : \"Japan\" }'\n       *\n       * @type {Object}\n       */\n      data: {\n        type: Object,\n        value: function() { return {}; },\n        observer: 'shouldUpdateInst'\n      }\n    },\n\n    createInst(options) {\n      return new PxMap.DataPopup(options);\n    },\n\n    updateInst(lastOptions, nextOptions) {\n      let updates = {};\n\n      if (lastOptions.title !== nextOptions.title) {\n        updates.title = nextOptions.title;\n      }\n      if (lastOptions.data !== nextOptions.data) {\n        updates.data = nextOptions.data;\n      }\n\n      if (Object.keys(updates).length) {\n        this.elementInst.updateSettings(updates);\n      }\n    },\n\n    getInstOptions() {\n      return {\n        title: this.title,\n        data: (typeof this.data === \"object\") ? this.data : {}\n      };\n    }\n  };\n  /* Bind DataPopup behavior */\n  namespace.DataPopup = [\n    namespace.Popup,\n    DataPopupImpl\n  ];\n\n  /****************************************************************************\n   * KLASSES\n   ****************************************************************************/\n\n  /* Ensures the klass namespace is created */\n  const klass = (window.PxMap = window.PxMap || {});\n\n  /**\n   *\n   * @class PxMap.InfoPopup\n   */\n  class InfoPopup extends L.Popup {\n    constructor(settings={}, config={}) {\n      super();\n      this._createPopup(settings, config);\n      return this;\n    }\n\n    // Note `createPopup` is an internet explorer native method, but deprecated\n    // so hopefully it won't cause grief\n    _createPopup(settings={}, config={}) {\n      this.settings = settings;\n      let {title, description, imgSrc} = settings;\n      let content = this._generatePopupContent(title, description, imgSrc);\n\n      let defaultConfig = {\n        className: 'map-popup-info'\n      };\n      let composedConfig = {};\n      Object.assign(composedConfig, defaultConfig, config);\n\n      this.initialize(composedConfig);\n      this.setContent(content);\n    }\n\n    _generatePopupContent(title, description, imgSrc) {\n      let tmplFnIf = (fn, ...vals) =>\n        vals.length && vals[0] !== undefined ? fn.call(this, ...vals) : '';\n\n      let imgTmpl = (imgSrc) => `\n        <div class=\"map-box-info__image\">\n          <img src=\"${imgSrc}\" />\n        </div>\n      `;\n      let titleTmpl = (title) => `\n        <p class=\"map-box-info__title\">${title}</p>\n      `;\n      let descriptionTmpl = (description) => `\n        <p class=\"map-box-info__description\">${description}</p>\n      `;\n\n      return `\n        <section class=\"map-box-info\">\n          ${tmplFnIf(imgTmpl, imgSrc)}\n          <div class=\"map-box-info__content\">\n            ${tmplFnIf(titleTmpl, title)}\n            ${tmplFnIf(descriptionTmpl, description)}\n          </div>\n        </section>\n      `;\n    }\n\n    updateSettings(settings={}) {\n      Object.assign(this.settings, settings);\n      let {title, description, imgSrc} = this.settings;\n      let content = this._generatePopupContent(title, description, imgSrc);\n      this.setContent(content);\n      this.update();\n    }\n  };\n  /* Bind InfoPopup klass */\n  klass.InfoPopup = InfoPopup;\n\n  /**\n   *\n   * @class PxMap.DataPopup\n   */\n  class DataPopup extends L.Popup {\n    constructor(settings={}, config={}) {\n      super();\n      this._createPopup(settings, config);\n      return this;\n    }\n\n    // Note `createPopup` is an internet explorer native method, but deprecated\n    // so hopefully it won't cause grief\n    _createPopup(settings={}, config={}) {\n      this.settings = settings;\n      let {title, data} = this.settings;\n      let content = this._generatePopupContent(title, data);\n\n      let defaultConfig = {\n        className: 'map-popup-data',\n        maxWidth: 400,\n        minWidth: 300\n      };\n      let composedConfig = {};\n      Object.assign(composedConfig, defaultConfig, config);\n\n      this.initialize(composedConfig);\n      this.setContent(content);\n    }\n\n    _generatePopupContent(title, data) {\n      let tmplFnIf = (fn, ...vals) =>\n        vals.length && vals[0] !== undefined ? fn.call(this, ...vals) : '';\n\n      let titleTmpl = (title) => `\n        <div class=\"map-data-box__header\">\n          <h3 class=\"map-data-box__header__text\">${title}</h3>\n        </div>\n      `;\n      let dataTmpl = (data) => {\n        let dataList = Object.keys(data).reduce((accum, key) => {\n          return accum.concat([dataItemTmpl(key, data[key])]);\n        }, []).join('');\n\n        return `\n          <div class=\"map-data-box__table\">\n            ${dataList}\n          </div>\n        `;\n      };\n      let dataItemTmpl = (label, value) => `\n        <div class=\"map-data-box__table__cell\"><p>${label}</p></div>\n        <div class=\"map-data-box__table__cell\"><p>${value}</p></div>\n      `;\n\n      return `\n        <section class=\"map-box-data\">\n          ${tmplFnIf(titleTmpl, title)}\n          ${tmplFnIf(dataTmpl, data)}\n        </section>\n      `;\n    }\n\n    updateSettings(settings={}) {\n      Object.assign(this.settings, settings);\n      let {title, data} = this.settings;\n      let content = this._generatePopupContent(title, data);\n\n      this.setContent(content);\n      this.update();\n    }\n  };\n  /* Bind DataPopup klass */\n  klass.DataPopup = DataPopup;\n\n})();\n"]}