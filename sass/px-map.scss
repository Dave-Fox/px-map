/*
 * Copyright (c) 2014 GE Global Research. All rights reserved.
 *
 * The copyright to the computer software herein is the property of
 * GE Global Research. The software may be used and/or copied only
 * with the written permission of GE Global Research or in accordance
 * with the terms and conditions stipulated in the agreement/contract
 * under which the software has been supplied.
 */

//
// Sass for the for the px-map component
//
// @author
//

// Settings
@import "px-colors-design/_settings.colors.scss";

// Tools
// ...

// Generic
@import "px-normalize-design/_generic.normalize.scss";
@import "px-box-sizing-design/_generic.box-sizing.scss";
@import "px-helpers-design/_generic.helpers.scss";

// Base
@import "px-typography-design/_base.typography.scss";
@import "px-flexbox-design/_base.flexbox.scss";
@import "px-viewport-design/_base.viewport.scss";

// Meta
@import "px-meta-buttons-design/_meta.buttons.scss";

// Objects
// ...

// Component

/*
 * Style variables shared across sub-components
 */
:host {
  --px-map-marker-group-unknown-color: var(--px-map-static-icon-unknown-color, $dv-light-gray);
  --px-map-marker-group-info-color: var(--px-map-static-icon-info-color, $primary-blue);
  --px-map-marker-group-warning-color: var(--px-map-static-icon-warning-color, $alert-orange);
  --px-map-marker-group-important-color: var(--px-map-static-icon-important-color, $alert-red);

  --px-map-marker-group-cluster-path-size: 10px;
  --px-map-marker-group-cluster-border-size: 5px;

  --px-map-marker-group-cluster-font-size: 15px;
}

/*
 * Override Leaflet's styles
 */
.leaflet-container {
  font-family: $predix-font-family;
  font-size: $inuit-base-font-size;
  line-height: $inuit-base-line-height;
}

/*******************************************************************************
 * ICONS (Attached to markers)
 ******************************************************************************/

// MAP ICON: BASE
@import "_map-icon.scss";

// MAP ICON: STATIC
@import "_map-icon-static.scss";

// MAP ICON: CLUSTER
.map-icon-cluster {
  @extend %map-icon !optional;
  display: block;
  position: absolute;
}

.map-icon-cluster__container {
  border-radius: 100%;
  background: var(--px-map-marker-group-cluster-background, white);
  display: block;
  position: relative;
}
.map-icon-cluster__svg {
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 100%;
  border-style: solid;
  border-width: var(--px-map-marker-group-cluster-border-size, 0);
  border-color: var(--px-map-marker-group-cluster-border-color, rgba(0,0,0,0.3));
}
.map-icon-cluster__body {
  display: flex;
  width: 100%;
  height: 100%;
  align-items: center;
  justify-content: center;

  color: var(--px-map-marker-group-cluster-font-color, inherit);
  font-size: var(--px-map-marker-group-cluster-font-size, inherit);
  font-weight: var(--px-map-marker-group-cluster-font-weight, inherit);
  line-height: var(--px-map-marker-group-cluster-line-height, inherit);
}

/*******************************************************************************
 * POPUPS
 ******************************************************************************/

// MAP POPUP: BASE
@import "_map-popup.scss";

// MAP POPUP: INFO
.map-popup-info {
  @extend %map-popup;

  .map-box-info {
    margin: $inuit-base-spacing-unit;
  }
}

// MAP POPUP: DATA
.map-popup-data {
  @extend %map-popup;

  .map-popup-data .map-box-data {
    margin: $inuit-base-spacing-unit;
  }
}

/*******************************************************************************
 * CONTROLS
 ******************************************************************************/

// MAP CONTROL: BASE

// Generic styles for a round button
%map-control-button {
  background-color: var(--px-map-control-button-background, $white);
  color: var(--px-map-control-button-text-color, $primary-blue);
  border-style: solid;
  border-width: var(--pax-map-control-button-border-width, 3px);
  border-color: var(--pax-map-control-button-border-color, rgba(0,0,0,.3));

  border-radius: 15%;
  line-height: calculateRem(36px);
  font-size: calculateRem(20px);
  font-weight: 400;

  margin-bottom: $inuit-base-spacing-unit--tiny;

  &:hover {
    background-color: var(--px-map-control-button-background, $gray3);
  }
}

// Extends generic button to be round
%map-control-button--round {
  width: calculateRem(40px);
  height: calculateRem(40px);
  position: relative;
  border-radius: 100%;
}

// MAP CONTROL: ZOOM

// Directly overwrite leaflet classes
.leaflet-touch .leaflet-control-layers,
.leaflet-touch .leaflet-bar,
.leaflet-control-zoom {
  border: none;
  border-radius: 0;
}
.leaflet-touch .leaflet-bar {
  a.leaflet-control-zoom-in,
  a.leaflet-control-zoom-out {
    @extend %map-control-button;
    @extend %map-control-button--round;
    position: relative;
    border-radius: 100%;
  }
  a.leaflet-control-zoom-in i,
  a.leaflet-control-zoom-out i {
    position: relative;
    left: -0.03rem;
    top: .55rem;
  }
  // Push the minus icon down a bit
  a.leaflet-control-zoom-out i {
    top: .59rem;
  }
}

/* CONTROL: Info control */

.map-info-control {
  background-color: white;
  max-width: 250px;
}
.map-info-control .map-box-info {
  margin: $inuit-base-spacing-unit;
}
.map-info-control .map-data-box {
  border: 1px solid $gray4;
}



/*******************************************************************************
 * GENERIC BOXES
 *
 * A `box` is a collection of information that can be placed into multiple
 * containers, like a `popup` or a `control`.
 ******************************************************************************/

 /* GENERIC: Info box generic styles, can be placed in multiple containers */

// Style for the title, which is a text tag
.map-box-info__title {
  font-weight: 600;
  margin: 0 0 $inuit-base-spacing-unit--tiny;
}
// Style for the description, which is a text tag
.map-box-info__description {
  margin: 0;
}
// Style for the optional image, which is set to the left of the content
.map-box-info__image {
  display: block;
  float: left;
  max-width: 75px;
  margin-right: $inuit-base-spacing-unit--small;
  img {
    max-width: 100%;
    height: auto;
  }
}
// We need the content container to be a block with overflow hidden to
// inset the picture to the left without text wrapping.
.map-box-info__content {
  display: block;
  overflow: hidden;
}

/* GENERIC: Data box generic styles, can be placed in multiple containers */

.map-data-box {
}
.map-data-box__header {
  padding: calculateRem(10px);
}
.map-data-box__header__text {
  text-transform: uppercase;
  font-size: calculateRem(12px);
  line-height: calculateRem(14px);
  margin: 0;
}
.map-data-box__table {
  display: flex;
  flex-wrap: wrap;
}
.map-data-box__table__cell {
  flex-grow: 1;
  overflow: hidden;
  width: 50%;

  border-top: 1px solid $gray4;
  &:nth-child(2n) { border-left: 1px solid $gray4; }

  padding: calculateRem(10px);
  text-transform: uppercase;
  font-size: calculateRem(12px);
  line-height: calculateRem(14px);
  p { margin: 0; }
}

/*******************************************************************************
 * VENDOR: PRUNE CLUSTER (TEMPORARY)
 *
 * Temporarily copying the PruneCluster plugin CSS before we rewrite it ourselves
 * to get the styles into the map scope.
 ******************************************************************************/

.prunecluster {
	font-size: 12px;
	border-radius: 20px;
	transition: all 0.3s linear;
}
.leaflet-marker-icon.prunecluster-anim,
.leaflet-marker-shadow.prunecluster-anim,
.leaflet-markercluster-icon.prunecluster-anim {
	transition: all 0.3s linear;
}

.leaflet-zoom-anim .leaflet-zoom-animated.leaflet-marker-icon,
.leaflet-zoom-anim .leaflet-zoom-animated.leaflet-marker-shadow,
.leaflet-zoom-anim .leaflet-zoom-animated.leaflet-markercluster-icon {
    transition: transform 0.25s cubic-bezier(0,0,0.25,1);
}
.prunecluster div {
	width: 30px;
	height: 30px;
	text-align: center;
	margin-left: 5px;
	margin-top: 5px;
	border-radius: 50%;
}
.prunecluster div span {
	line-height: 30px;
}

.prunecluster-small {
	background-color: #b5e28c;
	background-color: rgba(181, 226, 140, 0.6);
}

.prunecluster-small div {
	width: 28px;
	height: 28px;
	background-color: #6ecc39;
	background-color: rgba(110, 204, 57, 0.6);
}

.prunecluster-small div span {
	line-height: 28px;
}

.prunecluster-medium {
	background-color: #f1d357;
	background-color: rgba(241, 211, 87, 0.6);
}

.prunecluster-medium div {
	background-color: #f0c20c;
	background-color: rgba(240, 194, 12, 0.6);
}

.prunecluster-large {
	background-color: #fd9c73;
	background-color: rgba(253, 156, 115, 0.6);
}

.prunecluster-large div {
	width: 34px;
	height: 34px;
	background-color: #f18017;
	background-color: rgba(241, 128, 23, 0.6);
}

.prunecluster-large div span {
	line-height: 34px;
}


// Trumps
@import "inuit-clearfix/_trumps.clearfix.scss";
@import "px-spacing-responsive-design/_trumps.spacing-responsive.scss";
@import "px-widths-responsive-design/_trumps.widths-responsive.scss";
